<% if session.fetch(:user_id) == nil %>

  <div>
    <div>
      <h1>
        List of all bookmarks
      </h1>
    </div>
  </div>

  <hr>

  <div>
    <div>
      <h2>
        Add a new bookmark
      </h2>

      <form action="/insert_bookmark" method="post">
        <div>
          <label for="user_id_box">
            User
          </label>

          <input type="text" id="user_id_box" name="query_user_id">
        </div>

        <div>
          <label for="movie_id_box">
            Movie
          </label>

          <input type="text" id="movie_id_box" name="query_movie_id">
        </div>

        <button>
          Create bookmark
        </button>
      </form>
    </div>
  </div>

  <hr>
  <div>
    <div>
      <table>
        <tr>
          <th>
            ID
          </th>

          <th>
            User
          </th>

          <th>
            Movie
          </th>

          <th>
            Created at
          </th>

          <th>
            Updated at
          </th>

          <th>
          </th>
        </tr>

        <% @list_of_bookmarks.each do |a_bookmark| %>
        <tr>
          <td>
            <%= a_bookmark.id %>
          </td>

          <td>
            <%= a_bookmark.user_id %>
          </td>

          <td>
            <%= a_bookmark.movie_id %>
          </td>

          <td>
            <%= time_ago_in_words(a_bookmark.created_at) %> ago
          </td>
          <td>
            <%= time_ago_in_words(a_bookmark.updated_at) %> ago
          </td>

          <td>
            <a href="/bookmarks/<%= a_bookmark.id %>">
              Show details
            </a>
          </td>
        </tr>
        <% end %>
      </table>
    </div>
  </div>

  <hr>

<% else %>

  <h1>
    <%=User.where({:id => session.fetch(:user_id)}).at(0).fullname%>'s bookmarks
  </h1>

  <form action="/insert_bookmark" method="post">
    <select name="query_movie_id" id="movie_id_box">

      <% @list_of_movies.each do |display| %>
        <option value="<%= display.id %>">
          <%= display.title %>
        </option>
      <% end %>

    </select>

      <button>
        Bookmark this movie!
      </button>
    </form>

  <hr>

  <table border="1">
    <tr>
      <th>
        Movie
      </th>

      <th>
        Created at
      </th>

      <th>
      </th>
    </tr>

    <tr>
      <% @user_bookmarks.each do |display| %>
     
      <td>
        <a href="/movies/<%= Movie.where(:id => display.movie_id).at(0).id %>">
          <%= Movie.where(:id => display.movie_id).at(0).title %>
        </a>
      </td>

      <td>
        <%= display.created_at %>
      </td>

      <td>
        <a href="/delete_bookmark/<%= display.id %>">
          Un-bookmark
        </a>
      </td>
    </tr>

  <% end %>

  </table>

<% end %>